---
page_title: "Nscale: nscale_compute_cluster"
subcategory: ""
description: |-
  Nscale Compute Cluster
---

# Resource: nscale_compute_cluster

Compute clusters provide managed groups of machines organized into workload pools, where each pool can have distinct
configurations for flavor, image, replica count, and networking. Workload pools support autoscaling through replica
configuration, custom firewall rules for traffic control, public IP assignment, and user data for cloud-init
initialization. Pools also support allowed address pairs for router functionality. Each machine in a pool receives a
hostname and IP addresses for connectivity and has SSH access for management.

## Example Usage

```hcl
data "nscale_region" "glo1" {
  id = "XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
}

data "nscale_instance_flavor" "g_4_standard_40s" {
  id        = "XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
  region_id = data.nscale_region.glo1.id
}

resource "nscale_compute_cluster" "example" {
  name      = "example"
  region_id = data.nscale_region.glo1.id

  workload_pools = [
    {
      name             = "default"
      replicas         = 1
      image_id         = "XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"
      flavor_id        = data.nscale_instance_flavor.g_4_standard_40s.id
      enable_public_ip = true

      firewall_rules = [
        {
          direction = "ingress"
          protocol  = "tcp"
          ports     = 22
          prefixes  = ["0.0.0.0/0"]
        }
      ]
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the compute cluster.
- `workload_pools` (Attributes List) A list of pools of workload nodes in the compute cluster. (see [below for nested schema](#nestedatt--workload_pools))

### Optional

- `description` (String) The description of the compute cluster.
- `region_id` (String) The identifier of the region where the compute cluster is provisioned. If not specified, this defaults to the region ID configured in the provider.
- `tags` (Map of String) A map of tags assigned to the compute cluster.

### Read-Only

- `creation_time` (String) The timestamp when the compute cluster was created.
- `id` (String) An unique identifier for the compute cluster.
- `provisioning_status` (String) The provisioning status of the compute cluster.
- `ssh_private_key` (String, Sensitive) The SSH private key for accessing the compute cluster.

<a id="nestedatt--workload_pools"></a>
### Nested Schema for `workload_pools`

Required:

- `flavor_id` (String) The identifier of the flavor (machine type) used for the workload pool VMs.
- `image_id` (String) The identifier of the image used for initializing the boot disk of the workload pool VMs.
- `name` (String) The name of the workload pool.
- `replicas` (Number) The number of replicas (VMs) to provision in this workload pool.

Optional:

- `allowed_address_pairs` (Attributes Set) Allowed addresses that can pass through this workload pool's network ports. Each pair specifies a CIDR prefix and optionally a MAC address. Typically required when the machine is operating as a router. (see [below for nested schema](#nestedatt--workload_pools--allowed_address_pairs))
- `enable_public_ip` (Boolean) Whether to assign a public IP address to each VM in this workload pool. Default is `true`.
- `firewall_rules` (Attributes List) A list of firewall rules for the VMs in this workload pool. (see [below for nested schema](#nestedatt--workload_pools--firewall_rules))
- `user_data` (String) The data to pass to the VMs at boot time.

Read-Only:

- `machines` (Attributes List) A list of machines in this workload pool. (see [below for nested schema](#nestedatt--workload_pools--machines))

<a id="nestedatt--workload_pools--allowed_address_pairs"></a>
### Nested Schema for `workload_pools.allowed_address_pairs`

Required:

- `cidr` (String) The CIDR prefix to allow.

Optional:

- `mac_address` (String) The MAC address to allow. Optional.


<a id="nestedatt--workload_pools--firewall_rules"></a>
### Nested Schema for `workload_pools.firewall_rules`

Required:

- `ports` (String) The ports to which this firewall rule applies. This can be a single port, or a range of ports. For example: `22`, `80-443`.
- `prefixes` (Set of String) A set of CIDR prefixes to which this firewall rule applies.
- `protocol` (String) The IP protocol to which this firewall rule applies. Valid values are `tcp` or `udp`.

Optional:

- `direction` (String) The direction of the traffic to which this firewall rule applies. Default is `ingress`.


<a id="nestedatt--workload_pools--machines"></a>
### Nested Schema for `workload_pools.machines`

Read-Only:

- `hostname` (String) The hostname of the machine.
- `private_ip` (String) The private IP address of the machine.
- `public_ip` (String) The public IP address of the machine, if assigned.
